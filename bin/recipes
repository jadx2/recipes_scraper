#!/usr/bin/env ruby

require_relative '../lib/scraper_logic'
require_relative '../lib/menu'
require_relative '../lib/recipes.rb'
require_relative '../lib/styles'

def clear
  system 'clear' or system 'cls'
end

clear

puts "#{COLOR_1}WELCOME TO ALLSPICE SCRAPER#{COLOR_END}"
puts "#{COLOR_1}===========================#{COLOR_END}"
puts "\n"

def links
  ['78/breakfast-and-brunch/', '17561/lunch/', '17562/dinner/', '76/appetizers-and-snacks/', '156/bread/',
   '79/desserts/', '77/drinks/', '96/salad/', '81/side-dish/', '94/soups-stews-and-chili/']
end

def validator(selection)
  if selection.is_a?(Numeric) && selection.between?(1, 10)
    true
  else
    puts 'Category not found!'
  end
end

def menu_options
  menu = Menu.new
  valid = false
  category = ''
  until valid
    puts 'Choose category number:'
    puts "\n"
    menu.print_menu
    selection = gets.chomp.to_i
    puts "\n"
    if validator(selection)
      category = links[selection - 1]
      valid = true
    end
  end
  category
end

def find_recipes
  recipes = Recipes.new(menu_options)
  recipes.print_recipe
  puts "#{COLOR_DANGER_BG}Press 'Q' to quit or any key to go to the menu:#{COLOR_END}"

  if gets.chomp.upcase == 'Q'
    clear && exit
  else
    clear
    find_recipes
  end
end

find_recipes
